<div class="card-container">
  <div class="card-row">
    <div class="card-group">
      <div class="card-title-box small-title">CONTRACTS</div>

      <div class="card">
        <dx-data-grid
          [dataSource]="contracts"
          [showBorders]="true"
          keyExpr="id"
          [editing]="{
            mode: 'popup',
            allowUpdating: true,
            allowAdding: true,
            allowDeleting: true
          }"
          (onRowInserting)="onAdd($event, partnerIds)"
          (onRowUpdating)="onEdit($event)"
          (onRowRemoving)="onDelete($event)"
        >
          <!-- Columns -->
          <dxi-column
            dataField="title"
            caption="Contract Name"
            alignment="center"
          ></dxi-column>

          <dxi-column
            dataField="isActive"
            caption="Contract Active"
            dataType="boolean"
            alignment="center"
          ></dxi-column>

          <dxi-column
            caption="Partners"
            [calculateCellValue]="getPartnerNames"
            alignment="center"
          ></dxi-column>

          <!-- Popup & Form Configuration -->
          <dxo-editing
            mode="popup"
            [allowAdding]="true"
            [allowDeleting]="true"
            [allowUpdating]="true"
          >
            <dxo-popup
              title="Contract Details"
              [showTitle]="true"
              [width]="600"
              [height]="400"
            ></dxo-popup>

            <dxo-form>
              <dxi-item
                dataField="title"
                caption="Contract Name"
                [colSpan]="2"
              ></dxi-item>

              <dxi-item
                dataField="isActive"
                caption="Contract Active"
                [colSpan]="2"
              ></dxi-item>

              <!--  Multi-select Partner Dropdown -->
              <!-- <dxi-item dataField="partnerIds" [editorType]="'dxTagBox'" [editorOptions]="{
                  dataSource: partners,
                  displayExpr: 'name',
                  valueExpr: 'id',
                  showSelectionControls: true,
                  applyValueMode: 'useButtons',
                  searchEnabled: true,
                  onValueChanged: onPartnerChanged
                }" caption="Select Partners" [colSpan]="2"></dxi-item> -->

                <dxi-item
  dataField="partnerIds"
  [editorType]="'dxTagBox'"
  [editorOptions]="{
    dataSource: partners,
    displayExpr: 'name',
    valueExpr: 'id',
    showSelectionControls: true,
    applyValueMode: 'useButtons',
    searchEnabled: true,
    onValueChanged: onPartnerChanged
  }"
  caption="Select Partners"
  [colSpan]="2"
></dxi-item>

            </dxo-form>
          </dxo-editing>
        </dx-data-grid>
      </div>
    </div>
  </div>
</div>
